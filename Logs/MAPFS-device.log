2025-02-11 03:07:15,165 - INFO - Iniciando el servidor de métricas de Prometheus en el puerto 8012.
2025-02-11 03:07:15,169 - INFO - [REG] Conectado al CA en mapfs-cloud:5001
2025-02-11 03:07:15,169 - INFO - [REG] Enviada solicitud de registro al CA.
2025-02-11 03:07:15,169 - INFO - [REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 8464744957249099625994370110052869074687475431723204294956647899419685909999, 'y': 108330495870560314001334765849783478972087917747217734244631803944172317020102}, 'P_IoT_key': {'x': 12021120838187294349120682758061335992633244042551211022994102445570834789123, 'y': 20413704418981848390347933784357105187676960499565876377111948758419524459794}, 'operation': 'register'}.
2025-02-11 03:07:15,173 - INFO - [REG] Enviada información de registro al CA {'operation': 'register_device', 'IoT_Identity': 7606233644024350933, 'X_a_pub_key': {'x': 64504787047537028951280840469154940612257735771609974816282501083344681068285, 'y': 81665323327488420578978832385262036606095960017719637458258716441909019892141}, 'h_x': {'x': 108948983004075571557880565887364502628369822702868532451086462876567220815458, 'y': 32768061397682821078816489400731310619442138353343564151784690763587238902556}}.
2025-02-11 03:07:15,174 - INFO - [REG] Parámetros recibidos del CA: {'operation': 'register', 'sigma_a': 865263345985242961582856915306279835649924523287744040965154243091770743771, 'Y_a_pub_key': {'x': 106850477965740522649515616872372962969766811962812442930748592357505462702739, 'y': 82430793636564718423862019757289455933194257516858161634986136512234315351267}, 'h_a': 20202417442898961891023761163091069657921261227363447744060266797805877900795}.
2025-02-11 03:07:15,175 - INFO - [REG] Registro completado exitosamente con los siguientes parámetros: {'x_a_priv_key': 48679212020034390796907219862319410797053314376704978734482639215514815594782, 'X_a_pub_key': X: 0x8e9c6a68a7b271e1e59243af27c76e90011a848854d819e667dcf184e2bc66fd
Y: 0xb48cef5bd78b591ff4ce1b8ef0bcdbdcb623c82172fd4a073a873785435d59ad
(On curve <P256>), 'Y_a_pub_key': {'x': 106850477965740522649515616872372962969766811962812442930748592357505462702739, 'y': 82430793636564718423862019757289455933194257516858161634986136512234315351267}, 'sigma_a': 865263345985242961582856915306279835649924523287744040965154243091770743771, 'h_a': 20202417442898961891023761163091069657921261227363447744060266797805877900795}
2025-02-11 03:07:15,175 - INFO - Conectado al Gateway en mapfs-gateway:5000
2025-02-11 03:07:15,177 - INFO - [AUTH] Mensaje 'hello' enviado al Gateway {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 112767910792150089583992733354538376163779771700523620195554760046880264156073, 'y': 28362187815930013323386534524207872770678304306641522110239951837274930136609}}.
2025-02-11 03:07:15,177 - INFO - [AUTH] Token de autenticación del Gateway recibido: {'operation': b"\x9a\xebnjV\xae\xb6\x17\xa7\xb6'\x1a\xb6*'", 'W': {'x': 81988695737958893499321677795950546496961759040150108204727700975107630660446, 'y': 19013624910766695348660302895960758039579457290837086989602290582337469992361}, 'ID_w': 15350441766161075896, 'X_w_pub_key': {'x': 43863996758381919328903563930462085258800097890939185953139958082309445294518, 'y': 49684438295203867864068339520269516103309517999120882311337871419248825256535}, 'Y_w_pub_key': {'x': 9319592169209463828330262735997328537832613636237131980188580540069967321978, 'y': 26890014117410185413007263749415086014471241874987248180292502892816240477805}, 'sigma_z': 48626174388742323711794464350668296396420404333261464348042210995635850212522}
2025-02-11 03:07:15,182 - INFO - [AUTH] Autenticación de la firma del Gateway exitosa.
2025-02-11 03:07:15,185 - INFO - [AUTH] La llave de sesión en el dispositivo IoT es: 6036171043616457
2025-02-11 03:07:15,187 - INFO - [AUTH] Cómputo de la firma del dispositivo IoT completada.
2025-02-11 03:07:15,188 - INFO - [AUTH] Puntos, compromisos y respuestas ZKP enviadas al gateway: {'operation': 'mutual_authentication', 'P_1': {'x': 107060976904869687287060387379386091927547092182942899542576870606361659411840, 'y': 38863278925878934079445981419314271716037097918282861218746329284218611503902}, 'P_2': {'x': 56118538280330379880989110360414960237016512326213911771757681366521046315756, 'y': 15935296264451239851396017769040250081862542735009343444217627200080351635518}, 'P_3': {'x': 223843524953749382123565832193795443756530574792443313055182363775045063440, 'y': 72383174943674085198578910343235809552459129750318675145222394642255802186523}, 'sigma_t': 66930558779624729204914938510215340428525206354583891897223090395250680905564, 'T_1': {'x': 56139685082608743851115582571250074738453052118516592048875231839766967739415, 'y': 32795093558668314113730248008887883361173244482528509535087317614343782420239}, 'T_2': {'x': 11817822311652055303239113462056384898978044358018336429555562520450617468340, 'y': 67240531486854021458911447050259832689620507032560413341215869326708166055845}, 's_1': 11924845003190639865655475069717798206255386048011147904074598152536728500588, 's_2': 25679356705463260978129321502534249545192229570684723776678626850445051732800}
2025-02-11 03:07:15,201 - INFO - [AUTH] Autenticación mutua culminada.
