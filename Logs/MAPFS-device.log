time=2025-02-19 02:53:58,804 level=INFO msg=Iniciando el servidor de métricas de Prometheus en el puerto 8012.
time=2025-02-19 02:53:58,808 level=INFO msg=[REG] Conectado al CA en mapfs-cloud:5001
time=2025-02-19 02:53:58,809 level=INFO msg=[REG] Enviada solicitud de registro al CA.
time=2025-02-19 02:53:58,809 level=INFO msg=[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 112512620492388740365929121108166647622039923857522875903371471951301814656177, 'y': 44099420016543421608073585089923853888433988572748150781133370884716718955166}, 'P_IoT_key': {'x': 65746795317464666365014634778084194366294095211900563061308952562091292352601, 'y': 51170282752296907392465507162528324744359192759948160793583880614760432978616}, 'operation': 'register'}.
time=2025-02-19 02:53:58,813 level=INFO msg=[REG] Enviada información de registro al CA {'operation': 'register_device', 'IoT_Identity': 10450288320812497591, 'X_a_pub_key': {'x': 60768966087513296724294483912083021102407243915835135910235084846944711537587, 'y': 37242432278053605272610272936745181411403062970962819356446086764947509229921}, 'h_x': {'x': 63324308234922670708350925533538865666455330490256668661242226352877946220217, 'y': 3404785054757629950168915453653284159910155727047237310089126644659866613384}}.
time=2025-02-19 02:53:58,814 level=INFO msg=[REG] Parámetros recibidos del CA: {'operation': 'register', 'sigma_a': 25973737850259911501312668822208555625722446376759882476472889758120012048146, 'Y_a_pub_key': {'x': 26796175769091934662244545744014417405395245726329651774205041103552178027994, 'y': 11175004661736301338680014586648687370290753664126292583780886962270170011868}, 'h_a': 39088590771687634622760222543027786615911354418307017716933814686436635289036}.
time=2025-02-19 02:53:58,814 level=INFO msg=[REG] Registro completado exitosamente con los siguientes parámetros: {'x_a_priv_key': 21885098367339128219630860322428160163970761596278097493564215563045406147728, 'X_a_pub_key': X: 0x865a0413d3c32590bd656cfab6c9103e55e60f14ad59d0319a70e84a245af3b3
Y: 0x5256783cb92122ea26838eb5c41fb3edf360ec3ee3159b94d65c55362cf63961
(On curve <P256>), 'Y_a_pub_key': {'x': 26796175769091934662244545744014417405395245726329651774205041103552178027994, 'y': 11175004661736301338680014586648687370290753664126292583780886962270170011868}, 'sigma_a': 25973737850259911501312668822208555625722446376759882476472889758120012048146, 'h_a': 39088590771687634622760222543027786615911354418307017716933814686436635289036}
time=2025-02-19 02:53:58,815 level=INFO msg=Conectado al Gateway en mapfs-gateway:5000
time=2025-02-19 02:53:58,817 level=INFO msg=[AUTH] Mensaje 'hello' enviado al Gateway {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 101542333055562418001005406109230616126773173238595161661752128351633527318659, 'y': 81599398425551605009885534677840153965807898188671700694700792028236517638688}}.
time=2025-02-19 02:53:58,817 level=INFO msg=[AUTH] Token de autenticación del Gateway recibido: {'operation': b"\x9a\xebnjV\xae\xb6\x17\xa7\xb6'\x1a\xb6*'", 'W': {'x': 79524039037105678574330142905685810757961880516284834822345409071725491716501, 'y': 87615713260638255270114159751908935843938309855243896736214817891094668772705}, 'ID_w': 10166120176280311671, 'X_w_pub_key': {'x': 94749761194365382736558544279133488572774020486995520852354111387357166062636, 'y': 44365484224251859673385639438120952130044226661632487170472759518263585861405}, 'Y_w_pub_key': {'x': 83062168943621121819362866374316642429741331394508550008462311522037942704814, 'y': 40004269347049476067921417444995553512367027544928351173586625910852914607392}, 'sigma_z': 18057108840207595627106541122218213403263843079002291891297287982616300101203}
time=2025-02-19 02:53:58,822 level=INFO msg=[AUTH] Autenticación de la firma del Gateway exitosa.
time=2025-02-19 02:53:58,825 level=INFO msg=[AUTH] La llave de sesión en el dispositivo IoT es: 9218970930522513
time=2025-02-19 02:53:58,828 level=INFO msg=[AUTH] Cómputo de la firma del dispositivo IoT completada.
time=2025-02-19 02:53:58,828 level=INFO msg=[AUTH] Puntos, compromisos y respuestas ZKP enviadas al gateway: {'operation': 'mutual_authentication', 'P_1': {'x': 37921945020351624778821277884683420740844488173473871075756967423360671670432, 'y': 48455804507944768665890728183006594181109790624239744919356141320132727843194}, 'P_2': {'x': 95509344495595122470691521017850002993583174946987386977018801470610751027444, 'y': 75745759439377137739468936294390076988660974822625728261194729396549182012900}, 'P_3': {'x': 23959751631142891543326680422002374665822463041495595665354273072249067485359, 'y': 105365340794768992096165983372805819005192990937789587119245818536923566323315}, 'sigma_t': 1972595960765993098629229724566059539048808039620528852812416806788034134050, 'T_1': {'x': 31339402828789322423844278905359581125072266700440430014077295131675990679349, 'y': 52753671039208355626959681688488455420502661929889470405552338464424484935581}, 'T_2': {'x': 77357655240391250458704990950725091511742731624767601256356988513924249579982, 'y': 75508854863656237983515593739558879881526522570755268800779780871817956896435}, 's_1': 7603366102714269369174140467157038400604376454021184826705374946014655219939, 's_2': 75303682783742125158252110056346082643129798582390514667409136568986849127721}
time=2025-02-19 02:53:58,842 level=INFO msg=[AUTH] Autenticación mutua culminada.
time=2025-02-19 02:53:58,843 level=INFO msg=[METRICS] Métricas cifradas enviadas al Gateway: {'temperature': 28.23, 'humidity': 52.79}
time=2025-02-19 02:53:58,844 level=INFO msg=[METRICS] Respuesta recibida del Gateway: response_message = {'status': 'success', 'message': 'Métricas recibidas correctamente.'}
