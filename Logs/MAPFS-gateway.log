time=2025-02-19 02:53:53,336 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8010.'
time=2025-02-19 02:53:53,339 level=INFO msg='Conectado al CA en mapfs-cloud:5001'
time=2025-02-19 02:53:53,340 level=INFO msg='[REG] Enviada solicitud de registro al CA.'
time=2025-02-19 02:53:53,341 level=INFO msg='[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 112512620492388740365929121108166647622039923857522875903371471951301814656177, 'y': 44099420016543421608073585089923853888433988572748150781133370884716718955166}, 'P_IoT_key': {'x': 65746795317464666365014634778084194366294095211900563061308952562091292352601, 'y': 51170282752296907392465507162528324744359192759948160793583880614760432978616}, 'operation': b'\xad\xe8"\xb2\xd7\xab'}.'
time=2025-02-19 02:53:53,342 level=INFO msg='[REG] Enviada información de registro al CA: {'operation': 'register_gateway', 'Gateway_Identity': 10166120176280311671, 'X_w_pub_key': {'x': 94749761194365382736558544279133488572774020486995520852354111387357166062636, 'y': 44365484224251859673385639438120952130044226661632487170472759518263585861405}}.'
time=2025-02-19 02:53:53,343 level=INFO msg='[REG] Respuesta recibida del CA.'
time=2025-02-19 02:53:53,343 level=INFO msg='[REG] Parámetros recibidos del CA.'
time=2025-02-19 02:53:53,344 level=INFO msg='[REG] Registro completado exitosamente con los siguientes parámetros: {'x_w_priv_key': 5385303008260595390016915405192219674019370684474827400507098110369056634141, 'X_w_pub_key': X: 0xd17a76e1fba8cb6b6aab94b8ac2f2c6f89916471d79722ff8bc71c72b5224c2c
Y: 0x6215f965a0d2368befd754cbef90627818a9b52221bdfa8eb10fd94deb14ef1d
(On curve <P256>), 'Y_w_pub_key': {'x': 83062168943621121819362866374316642429741331394508550008462311522037942704814, 'y': 40004269347049476067921417444995553512367027544928351173586625910852914607392}, 'sigma_w': 76529986515490040127053790613103209174775982618491258960489772559118386253894, 'h_w': 92539595522125938604563010943561935528818887203438548011295299557533655830663}'
time=2025-02-19 02:53:53,344 level=INFO msg='Socket con el CA cerrado correctamente.'
time=2025-02-19 02:53:53,344 level=INFO msg='[REG] Conexión con el CA cerrada.'
time=2025-02-19 02:53:53,347 level=INFO msg='[REVOC] Esperando respuestas de revocación en el puerto 6000.'
time=2025-02-19 02:53:53,347 level=INFO msg='Socket Gateway escuchando en 0.0.0.0:5000'
time=2025-02-19 02:53:53,347 level=INFO msg='Monitoreando actividad sospechosa de los dispositivos'
time=2025-02-19 02:53:58,815 level=INFO msg='Conexión aceptada de ('172.18.0.10', 60344)'
time=2025-02-19 02:53:58,816 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 101542333055562418001005406109230616126773173238595161661752128351633527318659, 'y': 81599398425551605009885534677840153965807898188671700694700792028236517638688}}'
time=2025-02-19 02:53:58,816 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 101542333055562418001005406109230616126773173238595161661752128351633527318659, 'y': 81599398425551605009885534677840153965807898188671700694700792028236517638688}}'
time=2025-02-19 02:53:58,817 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 79524039037105678574330142905685810757961880516284834822345409071725491716501, 'y': 87615713260638255270114159751908935843938309855243896736214817891094668772705}, 'ID_w': 10166120176280311671, 'X_w_pub_key': {'x': 94749761194365382736558544279133488572774020486995520852354111387357166062636, 'y': 44365484224251859673385639438120952130044226661632487170472759518263585861405}, 'Y_w_pub_key': {'x': 83062168943621121819362866374316642429741331394508550008462311522037942704814, 'y': 40004269347049476067921417444995553512367027544928351173586625910852914607392}, 'sigma_z': 18057108840207595627106541122218213403263843079002291891297287982616300101203}'
time=2025-02-19 02:53:58,828 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
time=2025-02-19 02:53:58,829 level=INFO msg='[AUTH] Verificando la firma del IoT.'
time=2025-02-19 02:53:58,838 level=INFO msg='[AUTH] Llave pública del CA y I_1 verificados.'
time=2025-02-19 02:53:58,841 level=INFO msg='[AUTH] La llave de sesión en el gateway es: 9218970930522513'
time=2025-02-19 02:53:58,842 level=INFO msg='[AUTH] unique_identifier: 108498041593367404380713300358434736822008165079360365556912027539998693825654'
time=2025-02-19 02:53:58,842 level=INFO msg='[AUTH] Autenticación mutua culminada.'
time=2025-02-19 02:53:58,842 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
time=2025-02-19 02:53:58,843 level=INFO msg='Conexión con el cliente cerrada.'
time=2025-02-19 02:53:58,843 level=INFO msg='Conexión aceptada de ('172.18.0.10', 60348)'
time=2025-02-19 02:53:58,844 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 101542333055562418001005406109230616126773173238595161661752128351633527318659, 'y': 81599398425551605009885534677840153965807898188671700694700792028236517638688}, 'W': {'x': 79524039037105678574330142905685810757961880516284834822345409071725491716501, 'y': 87615713260638255270114159751908935843938309855243896736214817891094668772705}, 'iv': 'KzWkNLjmOUBx93dmWqqJzw==', 'encrypted_metrics': 'UpiUoH7tN+8sZpeqEH/PpBipH6PjZtnK/uE3KbaD+4HIyOB/YWa+ThdKf2hJS2cC'}'
time=2025-02-19 02:53:58,844 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.23, 'humidity': 52.79}'
time=2025-02-19 02:53:58,844 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
time=2025-02-19 02:53:58,845 level=INFO msg='Conexión con el cliente cerrada.'
