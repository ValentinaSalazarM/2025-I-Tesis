time=2025-02-19 17:05:28,042 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8010.'
time=2025-02-19 17:05:28,046 level=INFO msg='Conectado al CA en mapfs-cloud:5001'
time=2025-02-19 17:05:28,047 level=INFO msg='[REG] Enviada solicitud de registro al CA.'
time=2025-02-19 17:05:28,048 level=INFO msg='[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 58982910727406591773149193866434215305321679638060212212698689005489167279185, 'y': 63817539879840375984063540922096817369749874973830313328221850476624983922969}, 'P_IoT_key': {'x': 100960090091552154051890834456325932852527934642453312584702363733081816846557, 'y': 21150871519937674045865178625558738565440444635760214648169543258520515764444}, 'operation': b'\xad\xe8"\xb2\xd7\xab'}.'
time=2025-02-19 17:05:28,050 level=INFO msg='[REG] Enviada información de registro al CA: {'operation': 'register_gateway', 'Gateway_Identity': 5054384780250920130, 'X_w_pub_key': {'x': 6578189959177548948709574740954280790149262047476832593467412657065819595506, 'y': 37963870799803303046151828215053941595504197462290236434989911354034400754770}}.'
time=2025-02-19 17:05:28,051 level=INFO msg='[REG] Respuesta recibida del CA.'
time=2025-02-19 17:05:28,051 level=INFO msg='[REG] Parámetros recibidos del CA.'
time=2025-02-19 17:05:28,051 level=INFO msg='[REG] Registro completado exitosamente con los siguientes parámetros.'
time=2025-02-19 17:05:28,052 level=INFO msg='Socket con el CA cerrado correctamente.'
time=2025-02-19 17:05:28,052 level=INFO msg='[REG] Conexión con el CA cerrada.'
time=2025-02-19 17:05:28,053 level=INFO msg='[REVOC] Esperando respuestas de revocación en el puerto 6000.'
time=2025-02-19 17:05:28,053 level=INFO msg='Socket Gateway escuchando en 0.0.0.0:5000'
time=2025-02-19 17:05:28,053 level=INFO msg='Monitoreando actividad sospechosa de los dispositivos'
time=2025-02-19 17:05:33,759 level=INFO msg='Conexión aceptada de ('172.18.0.11', 50370)'
time=2025-02-19 17:05:33,759 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 106475430139134598601215426924534244214666208279346064446007527433719519528224, 'y': 47491497922498316215860209699981488015963115834066945213518625710643421970153}}'
time=2025-02-19 17:05:33,760 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 106475430139134598601215426924534244214666208279346064446007527433719519528224, 'y': 47491497922498316215860209699981488015963115834066945213518625710643421970153}}'
time=2025-02-19 17:05:33,760 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 7075304573304825258915267801395494285678939556643340562536251826398547408416, 'y': 21180338817384400336871302402103246521157787459437090269354751882633808996398}, 'ID_w': 5054384780250920130, 'X_w_pub_key': {'x': 6578189959177548948709574740954280790149262047476832593467412657065819595506, 'y': 37963870799803303046151828215053941595504197462290236434989911354034400754770}, 'Y_w_pub_key': {'x': 102214760338215359928538113623717914631214926124520697993789234570547299719973, 'y': 45166559857504411170138349254067246163418328523276515073559585692680639798640}, 'sigma_z': 22035900384351997720248319384682052162839293349070970648844556256632770058092}'
time=2025-02-19 17:05:33,772 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
time=2025-02-19 17:05:33,772 level=INFO msg='[AUTH] Verificando la firma del IoT.'
time=2025-02-19 17:05:33,782 level=INFO msg='[AUTH] Llave pública del CA y I_1 verificados.'
time=2025-02-19 17:05:33,785 level=INFO msg='[AUTH] La llave de sesión en el gateway es: 1150601951641441'
time=2025-02-19 17:05:33,785 level=INFO msg='[AUTH] unique_identifier: 112126724278369646089756045527152398355503530376609412826166177335563692148296'
time=2025-02-19 17:05:33,785 level=INFO msg='[AUTH] Autenticación mutua culminada.'
time=2025-02-19 17:05:33,786 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
time=2025-02-19 17:05:33,786 level=INFO msg='Conexión con el cliente cerrada.'
time=2025-02-19 17:05:33,786 level=INFO msg='Conexión aceptada de ('172.18.0.11', 50376)'
time=2025-02-19 17:05:33,786 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 106475430139134598601215426924534244214666208279346064446007527433719519528224, 'y': 47491497922498316215860209699981488015963115834066945213518625710643421970153}, 'W': {'x': 7075304573304825258915267801395494285678939556643340562536251826398547408416, 'y': 21180338817384400336871302402103246521157787459437090269354751882633808996398}, 'iv': 'BNeUw8Sh8o4XzT/8SuZpUQ==', 'encrypted_metrics': '1aSoxpqhlUiGHwq9NC15qsJaqthcZSphSxk4RkVytOORvZZTDBoIfjszXBAO/vYy'}'
time=2025-02-19 17:05:33,787 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 22.73, 'humidity': 60.37}'
time=2025-02-19 17:05:33,787 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
time=2025-02-19 17:05:33,787 level=INFO msg='Conexión con el cliente cerrada.'
time=2025-02-19 17:06:33,791 level=INFO msg='Conexión aceptada de ('172.18.0.11', 41340)'
time=2025-02-19 17:06:33,792 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 106475430139134598601215426924534244214666208279346064446007527433719519528224, 'y': 47491497922498316215860209699981488015963115834066945213518625710643421970153}, 'W': {'x': 7075304573304825258915267801395494285678939556643340562536251826398547408416, 'y': 21180338817384400336871302402103246521157787459437090269354751882633808996398}, 'iv': '9tM32a9ggCuFHEXeP39ayw==', 'encrypted_metrics': 'sHiCpKvi8/EDXGaXvnE+FC/gFB19elGUasJw6iAnVCttYYFixwaFovUf5J/CqaaQ'}'
time=2025-02-19 17:06:33,792 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 20.68, 'humidity': 64.21}'
time=2025-02-19 17:06:33,792 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
time=2025-02-19 17:06:33,793 level=INFO msg='Conexión con el cliente cerrada.'
