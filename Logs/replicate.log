2025-02-11 03:06:58,016 - INFO - Iniciando servicio de replicación.
2025-02-11 03:06:58,016 - INFO - No hay un archivo seleccionado. Buscando archivos.
2025-02-11 03:06:58,018 - INFO - No se encontraron archivos de análisis. Esperando.
2025-02-11 03:08:58,105 - INFO - No hay un archivo seleccionado. Buscando archivos.
2025-02-11 03:08:58,108 - INFO - Archivo seleccionado: /shared_data/capture_20250211-030659.pcap.analysis.json
2025-02-11 03:08:58,110 - INFO - Parámetros extraídos: {'device': {'one_time_public_key': {'x': 112767910792150089583992733354538376163779771700523620195554760046880264156073, 'y': 28362187815930013323386534524207872770678304306641522110239951837274930136609}, 'P_1': {'x': 107060976904869687287060387379386091927547092182942899542576870606361659411840, 'y': 38863278925878934079445981419314271716037097918282861218746329284218611503902}, 'P_2': {'x': 56118538280330379880989110360414960237016512326213911771757681366521046315756, 'y': 15935296264451239851396017769040250081862542735009343444217627200080351635518}, 'P_3': {'x': 223843524953749382123565832193795443756530574792443313055182363775045063440, 'y': 72383174943674085198578910343235809552459129750318675145222394642255802186523}, 'sigma_t': 66930558779624729204914938510215340428525206354583891897223090395250680905564, 'T_1': {'x': 56139685082608743851115582571250074738453052118516592048875231839766967739415, 'y': 32795093558668314113730248008887883361173244482528509535087317614343782420239}, 'T_2': {'x': 11817822311652055303239113462056384898978044358018336429555562520450617468340, 'y': 67240531486854021458911447050259832689620507032560413341215869326708166055845}, 's_1': 11924845003190639865655475069717798206255386048011147904074598152536728500588, 's_2': 25679356705463260978129321502534249545192229570684723776678626850445051732800}, 'gateway': {'W': {'x': 81988695737958893499321677795950546496961759040150108204727700975107630660446, 'y': 19013624910766695348660302895960758039579457290837086989602290582337469992361}, 'ID_w': 15350441766161075896, 'X_w_pub_key': {'x': 43863996758381919328903563930462085258800097890939185953139958082309445294518, 'y': 49684438295203867864068339520269516103309517999120882311337871419248825256535}, 'Y_w_pub_key': {'x': 9319592169209463828330262735997328537832613636237131980188580540069967321978, 'y': 26890014117410185413007263749415086014471241874987248180292502892816240477805}, 'sigma_z': 48626174388742323711794464350668296396420404333261464348042210995635850212522}}
2025-02-11 03:08:58,111 - INFO - Replica la comunicación en el sentido indicado.
2025-02-11 03:08:58,112 - INFO - Secuencia de mensajes device->gateway: [{'timestamp': '2025-02-11T03:07:15', 'src_ip': '172.19.0.10', 'dst_ip': '172.19.0.9', 'dst_port': 5000, 'payload': {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 112767910792150089583992733354538376163779771700523620195554760046880264156073, 'y': 28362187815930013323386534524207872770678304306641522110239951837274930136609}}}, {'timestamp': '2025-02-11T03:07:15', 'src_ip': '172.19.0.10', 'dst_ip': '172.19.0.9', 'dst_port': 5000, 'payload': {'operation': 'mutual_authentication', 'P_1': {'x': 107060976904869687287060387379386091927547092182942899542576870606361659411840, 'y': 38863278925878934079445981419314271716037097918282861218746329284218611503902}, 'P_2': {'x': 56118538280330379880989110360414960237016512326213911771757681366521046315756, 'y': 15935296264451239851396017769040250081862542735009343444217627200080351635518}, 'P_3': {'x': 223843524953749382123565832193795443756530574792443313055182363775045063440, 'y': 72383174943674085198578910343235809552459129750318675145222394642255802186523}, 'sigma_t': 66930558779624729204914938510215340428525206354583891897223090395250680905564, 'T_1': {'x': 56139685082608743851115582571250074738453052118516592048875231839766967739415, 'y': 32795093558668314113730248008887883361173244482528509535087317614343782420239}, 'T_2': {'x': 11817822311652055303239113462056384898978044358018336429555562520450617468340, 'y': 67240531486854021458911447050259832689620507032560413341215869326708166055845}, 's_1': 11924845003190639865655475069717798206255386048011147904074598152536728500588, 's_2': 25679356705463260978129321502534249545192229570684723776678626850445051732800}}]
2025-02-11 03:08:58,113 - INFO - Conectando a mapfs-gateway:5000
2025-02-11 03:08:58,114 - INFO - [Paso 1] Enviando payload: {"operation": "mutual_authentication", "step": "hello", "one_time_public_key": {"x": 112767910792150089583992733354538376163779771700523620195554760046880264156073, "y": 28362187815930013323386534524207872770678304306641522110239951837274930136609}}.
2025-02-11 03:08:58,116 - INFO - [Paso 1] Respuesta recibida: {"operation": "mutual_authentication", "W": {"x": 94260329094824692712277043641604878159047763422211240788717617045803215213427, "y": 57461428676188963824095726056983688348682643205120388541453433123716419494826}, "ID_w": 15350441766161075896, "X_w_pub_key": {"x": 43863996758381919328903563930462085258800097890939185953139958082309445294518, "y": 49684438295203867864068339520269516103309517999120882311337871419248825256535}, "Y_w_pub_key": {"x": 9319592169209463828330262735997328537832613636237131980188580540069967321978, "y": 26890014117410185413007263749415086014471241874987248180292502892816240477805}, "sigma_z": 86441351569776992622497303171854234254924116968239945722525558105235335033741}
2025-02-11 03:08:58,617 - INFO - [Paso 2] Enviando payload: {"operation": "mutual_authentication", "P_1": {"x": 107060976904869687287060387379386091927547092182942899542576870606361659411840, "y": 38863278925878934079445981419314271716037097918282861218746329284218611503902}, "P_2": {"x": 56118538280330379880989110360414960237016512326213911771757681366521046315756, "y": 15935296264451239851396017769040250081862542735009343444217627200080351635518}, "P_3": {"x": 223843524953749382123565832193795443756530574792443313055182363775045063440, "y": 72383174943674085198578910343235809552459129750318675145222394642255802186523}, "sigma_t": 66930558779624729204914938510215340428525206354583891897223090395250680905564, "T_1": {"x": 56139685082608743851115582571250074738453052118516592048875231839766967739415, "y": 32795093558668314113730248008887883361173244482528509535087317614343782420239}, "T_2": {"x": 11817822311652055303239113462056384898978044358018336429555562520450617468340, "y": 67240531486854021458911447050259832689620507032560413341215869326708166055845}, "s_1": 11924845003190639865655475069717798206255386048011147904074598152536728500588, "s_2": 25679356705463260978129321502534249545192229570684723776678626850445051732800}.
2025-02-11 03:08:58,623 - INFO - [Paso 2] Respuesta recibida: {"status": "error", "message": "Error autenticando el dispositivo IoT."}
2025-02-11 03:08:59,124 - ERROR - La réplica no finalizó correctamente.
2025-02-11 03:08:59,125 - INFO - El ataque no ha sido exitoso.
2025-02-11 03:10:59,219 - INFO - No hay un archivo seleccionado. Buscando archivos.
2025-02-11 03:10:59,223 - INFO - Archivo seleccionado: /shared_data/capture_20250211-030659.pcap.analysis.json
2025-02-11 03:10:59,225 - INFO - Parámetros extraídos: {'device': {'one_time_public_key': {'x': 112767910792150089583992733354538376163779771700523620195554760046880264156073, 'y': 28362187815930013323386534524207872770678304306641522110239951837274930136609}, 'P_1': {'x': 107060976904869687287060387379386091927547092182942899542576870606361659411840, 'y': 38863278925878934079445981419314271716037097918282861218746329284218611503902}, 'P_2': {'x': 56118538280330379880989110360414960237016512326213911771757681366521046315756, 'y': 15935296264451239851396017769040250081862542735009343444217627200080351635518}, 'P_3': {'x': 223843524953749382123565832193795443756530574792443313055182363775045063440, 'y': 72383174943674085198578910343235809552459129750318675145222394642255802186523}, 'sigma_t': 66930558779624729204914938510215340428525206354583891897223090395250680905564, 'T_1': {'x': 56139685082608743851115582571250074738453052118516592048875231839766967739415, 'y': 32795093558668314113730248008887883361173244482528509535087317614343782420239}, 'T_2': {'x': 11817822311652055303239113462056384898978044358018336429555562520450617468340, 'y': 67240531486854021458911447050259832689620507032560413341215869326708166055845}, 's_1': 11924845003190639865655475069717798206255386048011147904074598152536728500588, 's_2': 25679356705463260978129321502534249545192229570684723776678626850445051732800}, 'gateway': {'W': {'x': 81988695737958893499321677795950546496961759040150108204727700975107630660446, 'y': 19013624910766695348660302895960758039579457290837086989602290582337469992361}, 'ID_w': 15350441766161075896, 'X_w_pub_key': {'x': 43863996758381919328903563930462085258800097890939185953139958082309445294518, 'y': 49684438295203867864068339520269516103309517999120882311337871419248825256535}, 'Y_w_pub_key': {'x': 9319592169209463828330262735997328537832613636237131980188580540069967321978, 'y': 26890014117410185413007263749415086014471241874987248180292502892816240477805}, 'sigma_z': 48626174388742323711794464350668296396420404333261464348042210995635850212522}}
2025-02-11 03:10:59,226 - INFO - Replica la comunicación en el sentido indicado.
2025-02-11 03:10:59,227 - INFO - Secuencia de mensajes device->gateway: [{'timestamp': '2025-02-11T03:07:15', 'src_ip': '172.19.0.10', 'dst_ip': '172.19.0.9', 'dst_port': 5000, 'payload': {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 112767910792150089583992733354538376163779771700523620195554760046880264156073, 'y': 28362187815930013323386534524207872770678304306641522110239951837274930136609}}}, {'timestamp': '2025-02-11T03:07:15', 'src_ip': '172.19.0.10', 'dst_ip': '172.19.0.9', 'dst_port': 5000, 'payload': {'operation': 'mutual_authentication', 'P_1': {'x': 107060976904869687287060387379386091927547092182942899542576870606361659411840, 'y': 38863278925878934079445981419314271716037097918282861218746329284218611503902}, 'P_2': {'x': 56118538280330379880989110360414960237016512326213911771757681366521046315756, 'y': 15935296264451239851396017769040250081862542735009343444217627200080351635518}, 'P_3': {'x': 223843524953749382123565832193795443756530574792443313055182363775045063440, 'y': 72383174943674085198578910343235809552459129750318675145222394642255802186523}, 'sigma_t': 66930558779624729204914938510215340428525206354583891897223090395250680905564, 'T_1': {'x': 56139685082608743851115582571250074738453052118516592048875231839766967739415, 'y': 32795093558668314113730248008887883361173244482528509535087317614343782420239}, 'T_2': {'x': 11817822311652055303239113462056384898978044358018336429555562520450617468340, 'y': 67240531486854021458911447050259832689620507032560413341215869326708166055845}, 's_1': 11924845003190639865655475069717798206255386048011147904074598152536728500588, 's_2': 25679356705463260978129321502534249545192229570684723776678626850445051732800}}]
2025-02-11 03:10:59,228 - INFO - Conectando a mapfs-gateway:5000
2025-02-11 03:10:59,229 - INFO - [Paso 1] Enviando payload: {"operation": "mutual_authentication", "step": "hello", "one_time_public_key": {"x": 112767910792150089583992733354538376163779771700523620195554760046880264156073, "y": 28362187815930013323386534524207872770678304306641522110239951837274930136609}}.
2025-02-11 03:10:59,230 - INFO - [Paso 1] Respuesta recibida: {"operation": "mutual_authentication", "W": {"x": 45620439699423566840984660102845793878348552921512718476222396575410999205588, "y": 86411788964967206142341704830366001676559448086880345882285608104026909076978}, "ID_w": 15350441766161075896, "X_w_pub_key": {"x": 43863996758381919328903563930462085258800097890939185953139958082309445294518, "y": 49684438295203867864068339520269516103309517999120882311337871419248825256535}, "Y_w_pub_key": {"x": 9319592169209463828330262735997328537832613636237131980188580540069967321978, "y": 26890014117410185413007263749415086014471241874987248180292502892816240477805}, "sigma_z": 96137468433641440580793981754249957818960860528138311650072723186504063764229}
2025-02-11 03:10:59,731 - INFO - [Paso 2] Enviando payload: {"operation": "mutual_authentication", "P_1": {"x": 107060976904869687287060387379386091927547092182942899542576870606361659411840, "y": 38863278925878934079445981419314271716037097918282861218746329284218611503902}, "P_2": {"x": 56118538280330379880989110360414960237016512326213911771757681366521046315756, "y": 15935296264451239851396017769040250081862542735009343444217627200080351635518}, "P_3": {"x": 223843524953749382123565832193795443756530574792443313055182363775045063440, "y": 72383174943674085198578910343235809552459129750318675145222394642255802186523}, "sigma_t": 66930558779624729204914938510215340428525206354583891897223090395250680905564, "T_1": {"x": 56139685082608743851115582571250074738453052118516592048875231839766967739415, "y": 32795093558668314113730248008887883361173244482528509535087317614343782420239}, "T_2": {"x": 11817822311652055303239113462056384898978044358018336429555562520450617468340, "y": 67240531486854021458911447050259832689620507032560413341215869326708166055845}, "s_1": 11924845003190639865655475069717798206255386048011147904074598152536728500588, "s_2": 25679356705463260978129321502534249545192229570684723776678626850445051732800}.
2025-02-11 03:10:59,737 - INFO - [Paso 2] Respuesta recibida: {"status": "error", "message": "Error autenticando el dispositivo IoT."}
2025-02-11 03:11:00,238 - ERROR - La réplica no finalizó correctamente.
2025-02-11 03:11:00,239 - INFO - El ataque no ha sido exitoso.
